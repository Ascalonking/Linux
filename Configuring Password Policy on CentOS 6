сделать копию /etc/login.defs на /etc/login.defsback

в файле /etc/login.defs настраиваю срок пароля и длину пароля

Элементы управления срок пароля и длину пароля не влияют на существующих пользователей - они влияют только на вновь созданных пользователей!

PASS_MAX_DAYS — максимальное количество дней, в течение которых может использоваться пароль. 
PASS_MIN_DAYS — минимальное количество дней, отведенных между сменой пароля. 
PASS_MIN_LEN – минимально допустимая длина пароля. 
PASS_WARN_AGE — количество дней предупреждения, выдаваемого до истечения срока действия пароля.

PASS_MAX_DAYS 99999 (поменял на) -> 90
PASS_MIN_DAYS 0 -> 2
PASS_MIN_LEN 5 -> 8
PASS_WARN_AGE 7 -> 14



Сделал копию  /etc/pam.d/system-auth на /etc/pam.d/system-authback

в файле /etc/pam.d/system-auth настраивается сложность пароля и запрещает ряд повторно используемых паролей

Принудительные заглавные символы в паролях – ucredit=-X – где X – количество заглавных букв, необходимых в пароле
Принудительные строчные буквы в паролях – lcredit=-X – где X – количество символов нижнего регистра, необходимых в пароле
Принудительные номера в паролях – dcredit=-X – где X – число, необходимое для ввода пароля
Принудительное использование символов в паролях – ocredit=-X – где X – количество символов, необходимых в пароле
Запретить повторно используемые пароли – remember=X – где X – количество прошлых паролей, которые необходимо запретить

password requisite pam_cracklib.so try_first_pass retry=3 type= dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
password sufficient pam_unix.so sha512 shadow nullok try_first_pass use_authtok remember=5



В файле /etc/pam.d/password-auth и /etc/pam.d/system-auth настраивается количество ошибок входа в систему и время блокировки УЗ
Для настройки количества ошибок входа в систему необходимо добавить две новые строки в файл /etc/pam.d/password-auth и /etc/pam.d/system-auth
Параметр "deny=X" (где X — количество неудачных попыток входа)
unlock_time=X (где X — количество секунд таймаута)


auth        required      pam_tally2.so deny=5 onerr=failed unlock_time=180
account     required      pam_tally2.so
